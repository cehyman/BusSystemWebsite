<!DOCTYPE html>
<html>

<head>
	<title>Splash Screen</title>
	<link rel="stylesheet" href="style.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
	<h1>Please Log In.</h1>
	<label class="redLabel" id="labelLoginFailed"></label><br />

	<label>Username:</label>
	<input id="tUsername" type="text"><br><br>
	<label>Password:</label>
	<input id="tPassword" type="password"><br><br>
	<input id="buttonLogIn" type="button" value="Log In" />
	<script>
		$(document).ready(function () {
			$('#buttonLogIn').on('click', function () {
				var inputUsername = document.getElementById("tUsername").value;
				var inputPassword = document.getElementById("tPassword").value;
				$.ajax({
					url: "http://localhost:8080/loginRequest",
					type: "POST",
					data: {
						username: inputUsername,
						password: inputPassword,
					},
					dataType: 'json',
					success: function (result) {
						const LOGGEDIN = 0;
						const CREATED_ACCOUNT = 1;
						const INCORRECT_PASSWORD = 2;

						if (result.code == LOGGEDIN) {
							sessionStorage.setItem('username', inputUsername);
							location.href = "/routes";
						} else if (result.code == CREATED_ACCOUNT) {
							// can add some stuff here later if we want to treat registering and logging in differently
							document.getElementById("labelLoginFailed").innerHTML = "Created account with username " + inputUsername;
						} else if (result.code == INCORRECT_PASSWORD) {
							document.getElementById("labelLoginFailed").innerHTML = "Incorrect password.";
						} else {
							document.getElementById("labelLoginFailed").innerHTML = "Error contacting database. error: " + result.code;
						}
					}
				});
			});
		}); 
	</script>
</body>

</html>