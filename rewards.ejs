<!DOCTYPE html>
<html>
	<head>
		<title>Rewards</title>
		<link rel="stylesheet" href="style.css" />
		<script src="logOut.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	</head>

	<body>
		<h1>Welcome to the Rewards page.</h1>
		<p>Here will be where you can look at the rewards you have earned!</p>


        <h2>Rewards:</h2>
		<label>Your discount is:</label>
		<select id="rewardDisplay" onchange="populateRewards();">
		</select><br /><br />

		<h2 id="headerRewards"></h2>

		<label id="labelUsername"></label><br />
		<input id="buttonMyAcc" type="button" onclick="location.href = '/account';" value="My Account" />
		<input id="buttonLogOut" type="button" onclick="logOut();" value="Log Out" />
		<br /><br /><br />

		


	</body>
</html>

<script>
    function populateRewards() {
    //get reward from database about the user that is selected
    var user = document.getElementById("labelUsername").value;
    var table = document.getElementById("tableRewards");

    hRewards.innerHTML = "User: " + route;

    //clear the table
    while (table.hasChildNodes()) {
        table.removeChild(table.firstChild);
    }
    $.ajax({
        url: "http://localhost:8080/rewards",
        type: "POST",
        data: {
            route_id: route
        },
        dataType: 'json',
        success: function (result) {
            const NONEMPTY = 0;
            const EMPTY = 1;

            if (result.code == NONEMPTY) {
                var dbData = result.schedule;
                for (var i = 0; i < dbData.length; i++) {
                    var row = table.insertRow(i);
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    cell1.innerHTML = dbData[i].depart_time;
                    cell2.innerHTML = dbData[i].arrive_time;
                }
                var row = table.insertRow(0);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                cell1.innerHTML = "Departure Times";
                cell2.innerHTML = "Arrival Times";
            } else if (result.code == EMPTY) {
                var row = table.insertRow(0);
                var cell1 = row.insertCell(0);
                cell1.innerHTML = "No rewards found for user";
            } else {
                var row = table.insertRow(0);
                var cell1 = row.insertCell(0);
                cell1.innerHTML = "Error: " + result.code;
            }
        }
    });
}
</script>
